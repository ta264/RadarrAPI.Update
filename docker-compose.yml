version: '2'
services:
    mysql:
        image: mysql/mysql-server
        restart: always
        environment:
            - MYSQL_ROOT_PASSWORD
            - MYSQL_DATABASE=radarrupdate
            - MYSQL_USER=root
            - MYSQL_PASSWORD=${MYSQL_ROOT_PASSWORD}
        volumes:
          - ./my.cnf:/etc/my.cnf
        ports:
          - 3307:3306

        networks:
          - radarrupdate
            
    radarrupdate:
        build:
          context: .
          args:
            config: Debug

        restart: always
        ports:
            - "5000:5000"

        depends_on:
            - mysql

        environment:
            - Radarr:DataDirectory=/data
            - Radarr:Database=server=mysql;user id=root;password=${MYSQL_ROOT_PASSWORD};database=radarrupdate;CharSet=utf8mb4
            - Radarr:ApiKey=test
            - ASPNETCORE_URLS=http://0.0.0.0:5000

        volumes:
            - ./update-data:/data

        networks:
          - radarrupdate


networks:
  radarrupdate:
